@model CatalogoWeb.ViewModels.ProductFilterViewModel

<h2>Productos</h2>

<form method="get">
    <div>
        <label>Nombre:</label>
        <input type="text" name="Name" value="@Model.Name" />
    </div>

    <div>
        <label>Cantidad desde:</label>
        <input type="number" name="QuantityFrom" value="@Model.QuantityFrom" />
        <label>hasta:</label>
        <input type="number" name="QuantityTo" value="@Model.QuantityTo" />
    </div>

    <div>
        <label>Precio desde:</label>
        <input type="number" step="0.01" name="PriceFrom" value="@Model.PriceFrom" />
        <label>hasta:</label>
        <input type="number" step="0.01" name="PriceTo" value="@Model.PriceTo" />
    </div>

    <div>
        <label>Fecha desde:</label>
        <input type="date" name="DateFrom" value="@(Model.DateFrom?.ToString("yyyy-MM-dd"))" />
        <label>hasta:</label>
        <input type="date" name="DateTo" value="@(Model.DateTo?.ToString("yyyy-MM-dd"))" />
    </div>

    <div>
        <label>Categorías:</label>
        <select name="CategoryIds" multiple="multiple">
            @foreach (var c in Model.Categories)
            {
                if (Model.CategoryIds != null && Model.CategoryIds.Contains(c.Id))
                {
                    <option value="@c.Id" selected>@c.Name</option>
                }
                else
                {
                    <option value="@c.Id">@c.Name</option>
                }
            }

            @* Opción para productos sin categoría *@
            @if (Model.CategoryIds != null && Model.CategoryIds.Contains(0))
            {
                <option value="0" selected>Sin categoría</option>
            }
            else
            {
                <option value="0">Sin categoría</option>
            }
        </select>
    </div>

    <div style="margin-top:10px;">
        <button type="submit">Filtrar</button>
        <a href="@Url.Action("Index")">Limpiar</a>
    </div>
</form>

<a asp-action="Create">Crear Producto</a>

<table style="margin-top:20px;">
    <tr>
        <th>Nombre</th>
        <th>Precio</th>
        <th>Categoria</th>
        <th>Cantidad</th>
        <th>Imagen</th>
        <th>Acciones</th>
    </tr>
    @foreach(var p in Model.Products)
    {
        <tr>
            <td>@p.Name</td>
            <td>@p.Price</td>
            <td>@(p.Category?.Name ?? "Sin categoría")</td>
            <td>@p.Quantity</td>
            <td>
                <img src="@p.Images.FirstOrDefault(i => i.IsPrincipal)?.Path" width="100" />
            </td>
            <td>
                <a asp-action="Details" asp-route-id="@p.Id">Ver</a>
                <a asp-action="Edit" asp-route-id="@p.Id">Editar</a>
            </td>
        </tr>
    }
</table>