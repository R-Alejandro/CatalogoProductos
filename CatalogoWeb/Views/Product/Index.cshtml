@model CatalogoWeb.ViewModels.ProductFilterViewModel

<h2>Productos</h2>

<form method="get">
    <div>
        <label>Nombre:</label>
        <input type="text" name="Name" value="@Model.Name" />
    </div>

    <div>
        <label>Cantidad desde:</label>
        <input type="number" name="QuantityFrom" value="@Model.QuantityFrom" />
        <label>hasta:</label>
        <input type="number" name="QuantityTo" value="@Model.QuantityTo" />
    </div>

    <div>
        <label>Precio desde:</label>
        <input type="number" step="0.01" name="PriceFrom" value="@Model.PriceFrom" />
        <label>hasta:</label>
        <input type="number" step="0.01" name="PriceTo" value="@Model.PriceTo" />
    </div>

    <div>
        <label>Fecha desde:</label>
        <input type="date" name="DateFrom" value="@(Model.DateFrom?.ToString("yyyy-MM-dd"))" />
        <label>hasta:</label>
        <input type="date" name="DateTo" value="@(Model.DateTo?.ToString("yyyy-MM-dd"))" />
    </div>

    <div>
        <label>Categorías:</label>
        <input type="hidden" name="CategoryIds" value="" />
        <select name="CategoryIds" multiple="multiple">
            @foreach (var c in Model.Categories)
            {
                if (Model.CategoryIds != null && Model.CategoryIds.Contains(c.Id))
                {
                    <option value="@c.Id" selected>@c.Name</option>
                }
                else
                {
                    <option value="@c.Id">@c.Name</option>
                }
            }
            
            @if (Model.CategoryIds != null && Model.CategoryIds.Contains(0))
            {
                <option value="0" selected>Sin categoria</option>
            }
            else
            {
                <option value="0">Sin categoria</option>
            }
        </select>
    </div>

    <div style="margin-top:10px;">
        <button type="submit">Filtrar</button>
        <a href="@Url.Action("Index")">Limpiar</a>
    </div>
</form>

<a asp-action="Create">Crear Producto</a>

<table class="simple-table">
    <tr>
        <th>Nombre</th>
        <th>Precio</th>
        <th>Categoría</th>
        <th>Cantidad</th>
        <th>Imagen</th>
        <th>Acciones</th>
    </tr>

    @foreach (var p in Model.Products)
    {
        <tr>
            <td>@p.Name</td>
            <td>@p.Price.ToString("C", new System.Globalization.CultureInfo("es-CO")) COP</td>
            <td>@(p.Category?.Name ?? "Sin categoría")</td>
            <td>@p.Quantity</td>
            <td>
                <img src="@p.Images.FirstOrDefault(i => i.IsPrincipal)?.Path" width="100" />
            </td>
            <td>
                <a asp-action="Details" asp-route-id="@p.Id">Ver</a>
                <a asp-action="Edit" asp-route-id="@p.Id">Editar</a>
            </td>
        </tr>
    }
</table>

<style>
    .simple-table {
        width: 100%;
        border-collapse: collapse;
        margin-top: 20px;
        font-size: 14px;
    }

    .simple-table th,
    .simple-table td {
        border: 1px solid #ddd;
        padding: 8px 10px;
        text-align: left;
        vertical-align: middle;
    }

    .simple-table th {
        background-color: #f5f5f5;
        font-weight: 600;
    }

    .simple-table tr:nth-child(even) {
        background-color: #fafafa;
    }

    .simple-table tr:hover {
        background-color: #f0f0f0;
    }

    .simple-table img {
        border-radius: 4px;
        max-height: 80px;
        object-fit: cover;
    }

    .simple-table a {
        margin-right: 8px;
        text-decoration: none;
        color: #0066cc;
    }

    .simple-table a:hover {
        text-decoration: underline;
    }
</style>